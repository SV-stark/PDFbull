<!doctype html>
<html lang="en">

<head>
  <meta charset="UTF-8" />
  <link rel="stylesheet" href="styles/index.css" />
  <link rel="stylesheet" href="https://unpkg.com/@phosphor-icons/web@2.1.1/src/regular/style.css" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>PDFbull</title>
  <script type="module" src="/main.js" defer></script>
</head>

<body>
  <!-- Reading Progress Bar -->
  <div id="reading-progress-bar" class="reading-progress-bar"></div>

  <!-- Top Toolbar -->
  <div class="toolbar">
    <!-- Left Group: File Operations -->
    <div class="toolbar-group">
      <div class="recent-files-container">
        <button id="btn-open" class="primary" tooltip="Open PDF file (Ctrl+O)">
          <i class="ph ph-file-pdf"></i>
          <span class="toolbar-label">Open</span>
          <i class="ph ph-caret-down" style="margin-left: 4px; font-size: 12px;"></i>
        </button>
        <div id="recent-files-dropdown" class="recent-files-dropdown">
          <div class="recent-file-empty">
            <i class="ph ph-clock" style="font-size: 24px; margin-bottom: 8px;"></i>
            <div>No recent files</div>
          </div>
        </div>
      </div>

      <button id="btn-save" tooltip="Save (Ctrl+S)">
        <i class="ph ph-floppy-disk"></i>
        <span class="toolbar-label">Save</span>
      </button>

      <div class="toolbar-separator"></div>

      <button id="btn-print" tooltip="Print (Ctrl+P)">
        <i class="ph ph-printer"></i>
      </button>

      <button id="btn-bookmark" tooltip="Bookmark Page (Ctrl+D)">
        <i class="ph ph-bookmark-simple"></i>
      </button>

      <div class="toolbar-separator"></div>

      <button id="btn-undo" tooltip="Undo (Ctrl+Z)">
        <i class="ph ph-arrow-u-up-left"></i>
      </button>
      <button id="btn-redo" tooltip="Redo (Ctrl+Y)">
        <i class="ph ph-arrow-u-up-right"></i>
      </button>
    </div>

    <div class="spacer"></div>

    <!-- Center Group: Navigation -->
    <div class="toolbar-group">
      <button id="btn-prev" tooltip="Previous Page (←)">
        <i class="ph ph-caret-left"></i>
      </button>
      <div class="page-nav">
        <input type="number" id="page-input" class="page-input" min="1" value="1" title="Jump to page">
        <span id="page-indicator" tooltip="Current page">/ -</span>
      </div>
      <button id="btn-next" tooltip="Next Page (→)">
        <i class="ph ph-caret-right"></i>
      </button>
    </div>

    <div class="spacer"></div>

    <!-- Right Group: View Controls -->
    <div class="toolbar-group">
      <button id="btn-search-toggle" tooltip="Search (Ctrl+F)">
        <i class="ph ph-magnifying-glass"></i>
        <span class="toolbar-label">Search</span>
      </button>

      <div class="toolbar-separator"></div>

      <button id="btn-zoom-out" tooltip="Zoom Out (Ctrl+-)">
        <i class="ph ph-minus"></i>
      </button>
      <select id="zoom-select" class="zoom-select" title="Zoom level">
        <option value="fit-width">Fit Width</option>
        <option value="fit-page">Fit Page</option>
        <option value="0.5">50%</option>
        <option value="0.75">75%</option>
        <option value="1" selected>100%</option>
        <option value="1.25">125%</option>
        <option value="1.5">150%</option>
        <option value="2">200%</option>
      </select>
      <span id="zoom-level" class="zoom-level">100%</span>
      <button id="btn-zoom-in" tooltip="Zoom In (Ctrl++)">
        <i class="ph ph-plus"></i>
      </button>

      <div class="toolbar-separator"></div>

      <button id="btn-rotate" tooltip="Rotate Page">
        <i class="ph ph-arrow-clockwise"></i>
      </button>

      <button id="btn-export" tooltip="Export (Ctrl+E)">
        <i class="ph ph-export"></i>
        <span class="toolbar-label">Export</span>
      </button>

      <button id="btn-sidebar-left-toggle" tooltip="Toggle Thumbnails (Ctrl+B)">
        <i class="ph ph-sidebar"></i>
      </button>

      <button id="btn-sidebar-right-toggle" tooltip="Toggle Tools (Ctrl+Shift+B)">
        <i class="ph ph-sidebar" style="transform: scaleX(-1);"></i>
      </button>

      <button id="btn-fullscreen" tooltip="Fullscreen (F11)">
        <i class="ph ph-corners-out"></i>
      </button>

      <button id="btn-settings" tooltip="Settings (Ctrl+,)">
        <i class="ph ph-gear"></i>
      </button>
    </div>
  </div>

  <!-- Tab Bar -->
  <div class="tab-bar" id="tab-bar">
    <div class="tabs-container" id="tabs-container">
      <!-- Tabs will be injected here -->
    </div>
    <button id="btn-new-tab" class="new-tab-btn" tooltip="Open new tab (Ctrl+O)">
      <i class="ph ph-plus"></i>
    </button>
  </div>

  <!-- Main Content -->
  <div class="main-container">
    <!-- Sidebar -->
    <!-- Left Sidebar: Thumbnails (Navigation) -->
    <div class="sidebar sidebar-left" id="sidebar-left">
      <!-- Thumbnails - Navigation Panel -->
      <div class="sidebar-section thumbnails-section">
        <div class="sidebar-header">
          <i class="ph ph-images"></i>
          <span>Thumbnails</span>
        </div>
        <div class="thumbnail-list" id="thumbnail-list">
          <!-- Thumbnails injected here -->
        </div>
      </div>
    </div>

    <!-- PDF Canvas -->
    <div class="viewer-container" id="viewer-container">
      <div id="pages-container" class="pages-container"></div>

      <!-- Welcome / Empty State -->
      <div id="empty-state" class="empty-state">
        <i class="ph ph-file-pdf" style="font-size: 64px; opacity: 0.3;"></i>
        <h2>No document open</h2>
        <p>Drag and drop a PDF here, or press <kbd>Ctrl+O</kbd> to open</p>
      </div>

      <!-- Loading Spinner -->
      <div id="loading-spinner" class="loading-overlay hidden">
        <div class="spinner"></div>
        <span class="loading-text">Loading...</span>
      </div>

    </div>

    <!-- Right Sidebar: Tools, Layers, Actions -->
    <div class="sidebar sidebar-right" id="sidebar-right">
      <!-- Drawing Tools -->
      <div class="sidebar-section tools-section">
        <div class="sidebar-header">
          <i class="ph ph-pencil-simple"></i>
          <span>Drawing Tools</span>
        </div>
        <div class="tools-container">
          <button id="btn-highlight" class="tool-btn" data-tool="highlight" tooltip="Highlight (H)">
            <i class="ph ph-highlighter"></i>
            <span>Highlight</span>
          </button>
          <button id="btn-rectangle" class="tool-btn" data-tool="rectangle" tooltip="Rectangle (R)">
            <i class="ph ph-square"></i>
            <span>Rectangle</span>
          </button>
          <button id="btn-circle" class="tool-btn" data-tool="circle" tooltip="Circle (C)">
            <i class="ph ph-circle"></i>
            <span>Circle</span>
          </button>
          <button id="btn-line" class="tool-btn" data-tool="line" tooltip="Line (L)">
            <i class="ph ph-minus"></i>
            <span>Line</span>
          </button>
          <button id="btn-arrow" class="tool-btn" data-tool="arrow" tooltip="Arrow (A)">
            <i class="ph ph-arrow-up-right"></i>
            <span>Arrow</span>
          </button>
          <button id="btn-text" class="tool-btn" data-tool="text" tooltip="Text (T)">
            <i class="ph ph-text-t"></i>
            <span>Text</span>
          </button>
          <button id="btn-sticky" class="tool-btn" data-tool="sticky" tooltip="Sticky Note (N)">
            <i class="ph ph-note"></i>
            <span>Sticky Note</span>
          </button>
        </div>

        <!-- Color Picker - Contextual to Drawing Tools -->
        <div class="color-picker-row">
          <button class="color-btn active" data-color="#ffeb3b" style="background: #ffeb3b;"></button>
          <button class="color-btn" data-color="#ff5252" style="background: #ff5252;"></button>
          <button class="color-btn" data-color="#448aff" style="background: #448aff;"></button>
          <button class="color-btn" data-color="#69f0ae" style="background: #69f0ae;"></button>
          <button class="color-btn" data-color="#e040fb" style="background: #e040fb;"></button>
          <button class="color-btn" data-color="#ffffff" style="background: #ffffff;"></button>
          <input type="color" id="custom-color" class="color-input" value="#ffeb3b">
        </div>
      </div>

      <!-- Layers - Advanced Feature -->
      <div class="sidebar-section layers-section">
        <div class="sidebar-header">
          <i class="ph ph-stack"></i>
          <span>Layers</span>
        </div>
        <div class="layers-container" id="layers-container">
          <label class="layer-item">
            <input type="checkbox" checked data-layer="default">
            <span>Default Layer</span>
          </label>
        </div>
        <button id="btn-add-layer" class="tool-btn" style="margin-top: 8px;">
          <i class="ph ph-plus-circle"></i>
          <span>Add Layer</span>
        </button>
      </div>

      <!-- Actions -->
      <div class="sidebar-section actions-section">
        <div class="sidebar-header">
          <i class="ph ph-lightning"></i>
          <span>Actions</span>
        </div>
        <div class="tools-container">
          <button id="btn-scanner" class="tool-btn" tooltip="Scanner Mode">
            <i class="ph ph-scan"></i>
            <span>Scanner</span>
          </button>
          <button id="btn-crop" class="tool-btn" tooltip="Auto-crop whitespace">
            <i class="ph ph-crop"></i>
            <span>Auto Crop</span>
          </button>
          <button id="btn-forms" class="tool-btn" tooltip="Scan for form fields">
            <i class="ph ph-textbox"></i>
            <span>Scan Forms</span>
          </button>
          <button id="btn-compress" class="tool-btn" tooltip="Compress PDF file">
            <i class="ph ph-file-zip"></i>
            <span>Compress PDF</span>
          </button>
          <div class="ocr-btn-container">
            <button id="btn-ocr" class="tool-btn" tooltip="Extract text from images (OCR)">
              <i class="ph ph-text-aa"></i>
              <span>OCR</span>
            </button>
            <select id="ocr-language-select" class="ocr-language-select" title="OCR Language">
              <option value="en">English</option>
            </select>
          </div>
          <button id="btn-batch" class="tool-btn" tooltip="Batch processing">
            <i class="ph ph-stack"></i>
            <span>Batch Mode</span>
          </button>
          <button id="btn-filter-gray" class="tool-btn" tooltip="Toggle greyscale">
            <i class="ph ph-drop"></i>
            <span>Greyscale</span>
          </button>
          <button id="btn-filter-invert" class="tool-btn" tooltip="Toggle color inversion">
            <i class="ph ph-swap"></i>
            <span>Invert</span>
          </button>
        </div>
      </div>
    </div>

    <!-- Floating Controls (moved outside viewer to stay fixed) -->
    <div class="overlay">
      <button id="btn-fit-width" class="tool-btn">
        <i class="ph ph-arrows-out-horizontal"></i>
        <span>Fit Width</span>
      </button>
      <button id="btn-fit-page" class="tool-btn">
        <i class="ph ph-arrows-out"></i>
        <span>Fit Page</span>
      </button>
    </div>
  </div>

  <!-- Status Bar -->
  <div class="status-bar">
    <div class="status-item" id="status-doc">
      <i class="ph ph-file-text"></i>
      <span>No document open</span>
    </div>
    <div class="status-separator"></div>
    <div class="status-item">
      <i class="ph ph-file-pdf"></i>
      <span id="status-pages">0 pages</span>
    </div>
    <div class="status-separator"></div>
    <div class="status-item">
      <i class="ph ph-corners-out"></i>
      <span id="status-dimensions">-</span>
    </div>
    <div class="status-separator"></div>
    <div class="status-item" id="status-tool">
      <i class="ph ph-cursor"></i>
      <span id="current-tool">View</span>
    </div>
    <div class="spacer"></div>
    <div class="status-item" id="status-message">
      <span>Ready</span>
    </div>
  </div>

  <!-- Search Panel -->
  <div id="search-panel" class="search-panel hidden">
    <div class="search-header">
      <input type="text" id="ipt-search" class="search-input" placeholder="Search...">
      <div class="search-nav">
        <button id="btn-search-prev" tooltip="Previous Match">
          <i class="ph ph-caret-up"></i>
        </button>
        <span id="search-counter" class="search-counter">0/0</span>
        <button id="btn-search-next" tooltip="Next Match">
          <i class="ph ph-caret-down"></i>
        </button>
      </div>
      <button id="btn-search-exec" tooltip="Search">
        <i class="ph ph-magnifying-glass"></i>
      </button>
      <button id="btn-search-close" tooltip="Close" class="modal-close">
        <i class="ph ph-x"></i>
      </button>
    </div>
    <div class="search-options">
      <label class="search-option">
        <input type="checkbox" id="search-case-sensitive">
        <span>Case sensitive</span>
      </label>
      <label class="search-option">
        <input type="checkbox" id="search-whole-word">
        <span>Whole word</span>
      </label>
    </div>
    <div class="search-results" id="search-results">
      <div class="search-placeholder">Enter search term</div>
    </div>
  </div>

  <!-- Toast Container -->
  <div id="toast-container" class="toast-container"></div>

  <!-- Settings Modal -->
  <div id="settings-modal" class="modal hidden">
    <div class="modal-content settings-content">
      <div class="modal-header">
        <h3>Settings</h3>
        <button class="modal-close" id="btn-close-settings">
          <i class="ph ph-x"></i>
        </button>
      </div>

      <div class="settings-sidebar">
        <button class="settings-tab active" data-tab="appearance">
          <i class="ph ph-paint-brush"></i>
          <span>Appearance</span>
        </button>
        <button class="settings-tab" data-tab="behavior">
          <i class="ph ph-sliders"></i>
          <span>Behavior</span>
        </button>
        <button class="settings-tab" data-tab="performance">
          <i class="ph ph-gauge"></i>
          <span>Performance</span>
        </button>
        <button class="settings-tab" data-tab="files">
          <i class="ph ph-folder"></i>
          <span>Files</span>
        </button>
        <button class="settings-tab" data-tab="annotations">
          <i class="ph ph-pencil"></i>
          <span>Annotations</span>
        </button>
        <button class="settings-tab" data-tab="shortcuts">
          <i class="ph ph-keyboard"></i>
          <span>Shortcuts</span>
        </button>
      </div>

      <div class="settings-panels">
        <!-- Appearance Panel -->
        <div class="settings-panel active" id="panel-appearance">
          <h4>Appearance</h4>
          <div class="setting-section">
            <div class="setting-item">
              <div class="setting-info">
                <span class="setting-label">Theme</span>
                <span class="setting-desc">Choose your preferred visual theme</span>
              </div>
            </div>
            <div class="theme-selector-grid">
              <div class="theme-card active" data-theme="dark">
                <div class="theme-preview"></div>
                <span>Dark</span>
              </div>
              <div class="theme-card" data-theme="light">
                <div class="theme-preview"></div>
                <span>Light</span>
              </div>
              <div class="theme-card" data-theme="high-contrast">
                <div class="theme-preview"></div>
                <span>High Contrast</span>
              </div>
            </div>
          </div>

          <div class="setting-section">
            <div class="setting-item">
              <div class="setting-info">
                <span class="setting-label">Accent Color</span>
                <span class="setting-desc">Primary color for buttons and highlights</span>
              </div>
              <div class="setting-control">
                <div class="color-grid">
                  <div class="color-option" data-color="#646cff" style="background: #646cff;"></div>
                  <div class="color-option" data-color="#4f46e5" style="background: #4f46e5;"></div>
                  <div class="color-option" data-color="#ff5252" style="background: #ff5252;"></div>
                  <div class="color-option" data-color="#448aff" style="background: #448aff;"></div>
                  <div class="color-option" data-color="#69f0ae" style="background: #69f0ae;"></div>
                  <div class="color-option" data-color="#e040fb" style="background: #e040fb;"></div>
                  <input type="color" id="accent-color-picker" class="color-input" value="#646cff"
                    style="width: 32px; height: 32px; padding: 0; border: none; overflow: hidden; border-radius: 50%;">
                </div>
              </div>
            </div>

            <div class="setting-item">
              <div class="setting-info">
                <label for="setting-sidebar-width" class="setting-label">Sidebar Width</label>
                <span class="setting-desc">Adjust the width of the tool sidebar</span>
              </div>
              <div class="setting-control"
                style="width: 200px; flex-direction: column; align-items: flex-end; gap: 4px;">
                <span class="setting-value" id="sidebar-width-value">250px</span>
                <input type="range" id="setting-sidebar-width" min="200" max="400" value="250">
              </div>
            </div>

            <div class="setting-item">
              <div class="setting-info">
                <label for="setting-toolbar-labels" class="setting-label">Show Toolbar Labels</label>
                <span class="setting-desc">Show text labels alongside icons in the toolbar</span>
              </div>
              <div class="setting-control">
                <label class="toggle-switch">
                  <input type="checkbox" id="setting-toolbar-labels" checked>
                  <span class="toggle-slider"></span>
                </label>
              </div>
            </div>
          </div>
        </div>

        <!-- Behavior Panel -->
        <div class="settings-panel" id="panel-behavior">
          <h4>Behavior</h4>
          <div class="setting-item">
            <div class="setting-info">
              <label for="setting-default-zoom" class="setting-label">Default Zoom Level</label>
              <span class="setting-desc">Initial zoom level when opening a document</span>
            </div>
            <div class="setting-control">
              <select id="setting-default-zoom">
                <option value="fit-width">Fit Width</option>
                <option value="fit-page">Fit Page</option>
                <option value="100" selected>100%</option>
                <option value="125">125%</option>
                <option value="150">150%</option>
              </select>
            </div>
          </div>
          <div class="setting-item">
            <div class="setting-info">
              <label for="setting-autosave" class="setting-label">Auto-save Interval</label>
              <span class="setting-desc">How often to save changes automatically</span>
            </div>
            <div class="setting-control" style="width: 200px; flex-direction: column; align-items: flex-end; gap: 4px;">
              <span class="setting-value" id="autosave-value">30s</span>
              <input type="range" id="setting-autosave" min="0" max="300" value="30" step="10">
            </div>
          </div>
          <div class="setting-item">
            <div class="setting-info">
              <label for="setting-restore-session" class="setting-label">Restore Previous Session</label>
              <span class="setting-desc">Reopen files that were open when you last closed the app</span>
            </div>
            <div class="setting-control">
              <label class="toggle-switch">
                <input type="checkbox" id="setting-restore-session">
                <span class="toggle-slider"></span>
              </label>
            </div>
          </div>
          <div class="setting-item">
            <div class="setting-info">
              <label for="setting-smooth-scroll" class="setting-label">Smooth Scrolling</label>
              <span class="setting-desc">Enable smooth scrolling animation</span>
            </div>
            <div class="setting-control">
              <label class="toggle-switch">
                <input type="checkbox" id="setting-smooth-scroll" checked>
                <span class="toggle-slider"></span>
              </label>
            </div>
          </div>
          <div class="setting-item">
            <div class="setting-info">
              <label for="setting-double-click" class="setting-label">Double-click Action</label>
              <span class="setting-desc">What happens when you double-click the page</span>
            </div>
            <div class="setting-control">
              <select id="setting-double-click">
                <option value="nothing">Nothing</option>
                <option value="zoom">Toggle Zoom</option>
                <option value="fit-width">Fit to Width</option>
              </select>
            </div>
          </div>
        </div>

        <!-- Performance Panel -->
        <div class="settings-panel" id="panel-performance">
          <h4>Performance</h4>
          <div class="setting-item">
            <div class="setting-info">
              <label for="setting-cache-size" class="setting-label">Page Cache Size</label>
              <span class="setting-desc">Number of pages to keep in memory (higher uses more RAM)</span>
            </div>
            <div class="setting-control" style="width: 200px; flex-direction: column; align-items: flex-end; gap: 4px;">
              <span class="setting-value" id="cache-size-value">15 pages</span>
              <input type="range" id="setting-cache-size" min="5" max="50" value="15">
            </div>
          </div>
          <div class="setting-item">
            <div class="setting-info">
              <label for="setting-render-quality" class="setting-label">Render Quality</label>
              <span class="setting-desc">Trade-off between visual quality and performance</span>
            </div>
            <div class="setting-control">
              <select id="setting-render-quality">
                <option value="low">Low (Fast)</option>
                <option value="medium" selected>Medium</option>
                <option value="high">High (Slow)</option>
              </select>
            </div>
          </div>
          <div class="setting-item">
            <div class="setting-info">
              <label for="setting-hardware-accel" class="setting-label">Hardware Acceleration</label>
              <span class="setting-desc">Use GPU for rendering (recommended)</span>
            </div>
            <div class="setting-control">
              <label class="toggle-switch">
                <input type="checkbox" id="setting-hardware-accel" checked>
                <span class="toggle-slider"></span>
              </label>
            </div>
          </div>
        </div>

        <!-- Files Panel -->
        <div class="settings-panel" id="panel-files">
          <h4>Files</h4>
          <div class="setting-item">
            <div class="setting-info">
              <label for="setting-recent-files" class="setting-label">Recent Files Limit</label>
              <span class="setting-desc">Number of recent files to remember</span>
            </div>
            <div class="setting-control" style="width: 200px; flex-direction: column; align-items: flex-end; gap: 4px;">
              <span class="setting-value" id="recent-files-value">10 files</span>
              <input type="range" id="setting-recent-files" min="5" max="50" value="10">
            </div>
          </div>
          <div class="setting-item">
            <div class="setting-info">
              <label for="setting-auto-open" class="setting-label">Auto-open Last File</label>
              <span class="setting-desc">Automatically open the last viewed file on startup</span>
            </div>
            <div class="setting-control">
              <label class="toggle-switch">
                <input type="checkbox" id="setting-auto-open">
                <span class="toggle-slider"></span>
              </label>
            </div>
          </div>
          <div class="setting-item">
            <div class="setting-info">
              <label for="setting-default-path" class="setting-label">Default Save Location</label>
              <span class="setting-desc">Directory where files are saved by default</span>
            </div>
            <div class="setting-control">
              <div style="display: flex; gap: 8px;">
                <input type="text" id="setting-default-path" placeholder="Same as source file" readonly>
                <button id="btn-browse-path" class="secondary-btn">Browse</button>
              </div>
            </div>
          </div>
        </div>

        <!-- Annotations Panel -->
        <div class="settings-panel" id="panel-annotations">
          <h4>Annotations</h4>
          <div class="setting-item">
            <div class="setting-info">
              <span class="setting-label">Default Annotation Color</span>
              <span class="setting-desc">Default color for new annotations</span>
            </div>
            <div class="setting-control">
              <div class="color-grid">
                <div class="color-option active" data-anno-color="#ffeb3b" style="background: #ffeb3b;"></div>
                <div class="color-option" data-anno-color="#ff5252" style="background: #ff5252;"></div>
                <div class="color-option" data-anno-color="#448aff" style="background: #448aff;"></div>
                <div class="color-option" data-anno-color="#69f0ae" style="background: #69f0ae;"></div>
                <div class="color-option" data-anno-color="#e040fb" style="background: #e040fb;"></div>
                <div class="color-option" data-anno-color="#ffffff" style="background: #ffffff;"></div>
              </div>
            </div>
          </div>
          <div class="setting-item">
            <div class="setting-info">
              <label for="setting-sticky-width" class="setting-label">Sticky Note Width</label>
              <span class="setting-desc">Default width for sticky notes</span>
            </div>
            <div class="setting-control" style="width: 200px; flex-direction: column; align-items: flex-end; gap: 4px;">
              <span class="setting-value" id="sticky-width-value">150px</span>
              <input type="range" id="setting-sticky-width" min="100" max="300" value="150">
            </div>
          </div>
          <div class="setting-item">
            <div class="setting-info">
              <label for="setting-sticky-height" class="setting-label">Sticky Note Height</label>
              <span class="setting-desc">Default height for sticky notes</span>
            </div>
            <div class="setting-control" style="width: 200px; flex-direction: column; align-items: flex-end; gap: 4px;">
              <span class="setting-value" id="sticky-height-value">100px</span>
              <input type="range" id="setting-sticky-height" min="80" max="200" value="100">
            </div>
          </div>
        </div>

        <!-- Shortcuts Panel -->
        <div class="settings-panel" id="panel-shortcuts">
          <h4>Keyboard Shortcuts</h4>
          <div class="shortcuts-list">
            <div class="shortcut-item"><span>Open File</span><kbd>Ctrl+O</kbd></div>
            <div class="shortcut-item"><span>Save</span><kbd>Ctrl+S</kbd></div>
            <div class="shortcut-item"><span>Undo</span><kbd>Ctrl+Z</kbd></div>
            <div class="shortcut-item"><span>Redo</span><kbd>Ctrl+Y</kbd></div>
            <div class="shortcut-item"><span>Search</span><kbd>Ctrl+F</kbd></div>
            <div class="shortcut-item"><span>Settings</span><kbd>Ctrl+,</kbd></div>
            <div class="shortcut-item"><span>Zoom In</span><kbd>Ctrl++</kbd></div>
            <div class="shortcut-item"><span>Zoom Out</span><kbd>Ctrl+-</kbd></div>
            <div class="shortcut-item"><span>Toggle Sidebar</span><kbd>Ctrl+B</kbd></div>
            <div class="shortcut-item"><span>Fullscreen</span><kbd>F11</kbd></div>
          </div>
        </div>
      </div>

      <div class="modal-footer">
        <button id="btn-save-settings" class="primary-btn">
          <i class="ph ph-floppy-disk"></i>
          <span>Save Changes</span>
        </button>
      </div>
    </div>
  </div>

  <!-- Export Options Modal -->
  <div id="export-modal" class="modal hidden">
    <div class="modal-content export-content">
      <div class="modal-header">
        <h3>Export Options</h3>
        <button class="modal-close" id="btn-close-export">
          <i class="ph ph-x"></i>
        </button>
      </div>
      <div class="modal-body export-body">
        <div class="export-options-grid">
          <button class="export-card" id="btn-export-image">
            <i class="ph ph-image"></i>
            <div class="export-info">
              <span class="export-title">Export as Image</span>
              <span class="export-desc">Save current page as a high-quality PNG image</span>
            </div>
          </button>

          <button class="export-card" id="btn-export-text">
            <i class="ph ph-text-aa"></i>
            <div class="export-info">
              <span class="export-title">Extract Text</span>
              <span class="export-desc">Extract all text from the document to a .txt file</span>
            </div>
          </button>



          <button class="export-card" id="btn-export-json">
            <i class="ph ph-code"></i>
            <div class="export-info">
              <span class="export-title">Export Annotations</span>
              <span class="export-desc">Save all highlights and notes as a JSON file</span>
            </div>
          </button>
        </div>
      </div>
    </div>
  </div>

  <!-- Scanner Modal -->
  <div id="scanner-modal" class="modal hidden">
    <div class="modal-content scanner-content">
      <div class="modal-header">
        <h3>Scanner Mode</h3>
        <button class="modal-close" id="btn-close-scanner">
          <i class="ph ph-x"></i>
        </button>
      </div>

      <div class="scanner-body">
        <div class="scanner-preview-area">
          <div class="scanner-preview-wrapper" id="scanner-preview-wrapper">
            <canvas id="scanner-preview-canvas"></canvas>
            <div class="compare-hint">
              <i class="ph ph-eye"></i> Hold to compare
            </div>
          </div>
        </div>

        <div class="scanner-controls-sidebar">
          <div class="scanner-section">
            <label class="setting-label">Filter</label>
            <div class="filter-grid">
              <button class="filter-card active" data-filter="original" tooltip="No Filter">
                <i class="ph ph-image"></i>
                <span>Original</span>
              </button>
              <button class="filter-card" data-filter="grayscale" tooltip="Grayscale">
                <i class="ph ph-drop-half"></i>
                <span>Grayscale</span>
              </button>
              <button class="filter-card" data-filter="bw" tooltip="High Contrast B&W">
                <i class="ph ph-circle-half"></i>
                <span>B&W</span>
              </button>
              <button class="filter-card" data-filter="lighten" tooltip="Remove shadows/Lighten">
                <i class="ph ph-sun-dim"></i>
                <span>Lighten</span>
              </button>
              <button class="filter-card" data-filter="eco" tooltip="Save ink (Eco Mode)">
                <i class="ph ph-leaf"></i>
                <span>Eco</span>
              </button>
              <button class="filter-card" data-filter="noshadow" tooltip="Aggressive shadow removal">
                <i class="ph ph-lamp"></i>
                <span>No Shadow</span>
              </button>
            </div>
          </div>

          <div class="scanner-section">
            <label for="filter-intensity" class="setting-label">Intensity</label>
            <div class="intensity-control">
              <div class="intensity-header">
                <span>Strength</span>
                <span id="intensity-value">50%</span>
              </div>
              <input type="range" id="filter-intensity" min="0" max="100" value="50">
            </div>
          </div>

          <div class="scanner-actions">
            <button id="btn-scanner-apply" class="primary-btn btn-large">
              <i class="ph ph-check"></i>
              <span>Save Filtered PDF</span>
            </button>
            <button id="btn-scanner-cancel" class="secondary-btn btn-large"
              onclick="document.getElementById('scanner-modal').classList.add('hidden')">
              <span>Cancel</span>
            </button>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- OCR Progress Dialog -->
  <div id="ocr-progress-modal" class="modal hidden">
    <div class="modal-content ocr-progress-content">
      <div class="modal-header">
        <h3><i class="ph ph-text-aa"></i> OCR in Progress</h3>
      </div>
      <div class="modal-body ocr-progress-body">
        <div class="ocr-progress-info">
          <span id="ocr-page-progress" class="ocr-page-progress">Page 0/0</span>
          <span id="ocr-percentage" class="ocr-percentage">0%</span>
        </div>
        <div class="ocr-progress-bar-container">
          <div id="ocr-progress-bar" class="ocr-progress-bar" style="width: 0%"></div>
        </div>
        <p class="ocr-progress-hint">Extracting text from images...</p>
        <button id="btn-cancel-ocr" class="cancel-ocr-btn">
          <i class="ph ph-x-circle"></i>
          <span>Cancel OCR</span>
        </button>
      </div>
    </div>
  </div>

  <!-- Keyboard Help Modal -->
  <div id="keyboard-help-modal" class="modal hidden">
    <div class="modal-content">
      <div class="modal-header">
        <h3>Keyboard Shortcuts</h3>
        <button class="modal-close" id="btn-close-keyboard-help">
          <i class="ph ph-x"></i>
        </button>
      </div>
      <div class="modal-body">
        <div class="shortcuts-list">
          <div class="shortcut-item"><span>Open File</span><kbd>Ctrl+O</kbd></div>
          <div class="shortcut-item"><span>Save</span><kbd>Ctrl+S</kbd></div>
          <div class="shortcut-item"><span>Undo</span><kbd>Ctrl+Z</kbd></div>
          <div class="shortcut-item"><span>Redo</span><kbd>Ctrl+Y</kbd></div>
          <div class="shortcut-item"><span>Search</span><kbd>Ctrl+F</kbd></div>
          <div class="shortcut-item"><span>Settings</span><kbd>Ctrl+,</kbd></div>
          <div class="shortcut-item"><span>Zoom In</span><kbd>Ctrl++</kbd></div>
          <div class="shortcut-item"><span>Zoom Out</span><kbd>Ctrl+-</kbd></div>
          <div class="shortcut-item"><span>Toggle Sidebar</span><kbd>Ctrl+B</kbd></div>
          <div class="shortcut-item"><span>Fullscreen</span><kbd>F11</kbd></div>
          <div class="shortcut-item"><span>Bookmark</span><kbd>Ctrl+D</kbd></div>
          <div class="shortcut-item"><span>Print</span><kbd>Ctrl+P</kbd></div>
          <div class="shortcut-item"><span>Help</span><kbd>? / F1</kbd></div>
        </div>
      </div>
    </div>
  </div>
  <!-- Command Palette -->
  <div id="command-palette-overlay" class="command-palette-overlay hidden">
    <div class="command-palette-modal">
      <div class="command-palette-header">
        <i class="ph ph-terminal-window"></i>
        <input type="text" id="command-palette-input" placeholder="Type a command..." autocomplete="off">
      </div>
      <div id="command-palette-list" class="command-palette-list"></div>
      <div class="command-palette-footer">
        <span><kbd>↑↓</kbd> to navigate</span>
        <span><kbd>↵</kbd> to select</span>
        <span><kbd>esc</kbd> to close</span>
      </div>
    </div>
  </div>

  <!-- Custom Context Menu -->
  <div id="custom-context-menu" class="custom-context-menu hidden"></div>
</body>

</html>