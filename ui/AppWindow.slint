import { Button, HorizontalBox, ScrollView, VerticalBox } from "std-widgets.slint";

export component AppWindow inherits Window {
    title: "PDFbull";
    width: 1200px;
    height: 800px;

    in-out property<int> current_page: 0;
    in-out property<int> total_pages: 0;
    in-out property<float> zoom: 1.0;
    in-out property<string> status_text: "Ready - Open a PDF to begin";
    in-out property<bool> sidebar_visible: true;
    in-out property<image> pdf_page_image; 

    // Callbacks to request updates
    callback open_document();
    callback close_document();
    callback request_render(int, float);

    changed current_page => {
        request_render(current_page, zoom);
    }
    
    background: #2d2d2d;

    VerticalBox {
        padding: 0px;

        Rectangle {
            background: #1a1a1a;
            height: 48px;
            
            HorizontalBox {
                padding: 8px;
                spacing: 12px;
                alignment: start;
                
                Button {
                    text: "ðŸ“‚ Open PDF";
                    clicked => { open_document(); }
                    min_width: 100px;
                }
                Button {
                    text: "Close";
                    clicked => { close_document(); }
                }
            }
        }

        HorizontalLayout {
            padding: 0px;
            spacing: 0px;

            if sidebar_visible : Rectangle {
                width: 220px;
                background: #252525;
                
                Rectangle {
                    width: 1px;
                    background: #3d3d3d;
                    x: parent.width - 1px;
                }
                
                VerticalBox {
                    padding: 12px;
                    Text { 
                        text: "Thumbnails"; 
                        font_size: 16px; 
                        font_weight: 700; 
                        color: #ffffff;
                    }
                    Text { 
                        text: "Page navigation coming soon"; 
                        font_size: 12px; 
                        color: #888888;
                    }
                }
            }

            VerticalLayout {
                padding: 0px;
                spacing: 0px;

                Rectangle {
                    height: 52px;
                    background: #1a1a1a;
                    
                    Rectangle {
                        height: 1px;
                        background: #3d3d3d;
                        y: parent.height - 1px;
                    }
                    
                    HorizontalBox {
                        padding: 8px;
                        spacing: 12px;
                        alignment: start;

                        Button {
                            text: "â—€ Prev";
                            clicked => {
                                if (current_page > 0) {
                                    current_page -= 1;
                                }
                            }
                            min_width: 80px;
                        }

                        Text {
                            text: "Page " + (current_page + 1) + " of " + total_pages;
                            vertical_alignment: center;
                            color: #ffffff;
                            font_size: 16px;
                            font_weight: 600;
                        }

                        Button {
                            text: "Next â–¶";
                            clicked => {
                                if (current_page < total_pages - 1) {
                                    current_page += 1;
                                }
                            }
                            min_width: 80px;
                        }

                        Button {
                            text: "âˆ’ Zoom Out";
                            clicked => { 
                                zoom = max(0.25, zoom / 1.25); 
                                request_render(current_page, zoom);
                            }
                        }

                        Text {
                            text: round(zoom * 100) + "%";
                            vertical_alignment: center;
                            color: #ffffff;
                            font_size: 16px;
                            font_weight: 600;
                        }

                        Button {
                            text: "+ Zoom In";
                            clicked => { 
                                zoom = min(5.0, zoom * 1.25); 
                                request_render(current_page, zoom);
                            }
                        }
                    }
                }

                ScrollView {
                    Rectangle {
                        background: #404040;
                        
                        HorizontalLayout { alignment: center; 
                            VerticalLayout { alignment: center;
                                Image {
                                    source: pdf_page_image;
                                }
                            }
                        }
                    }
                }
            }
        }

        Rectangle {
            height: 32px;
            background: #1a1a1a;
            
            Rectangle {
                height: 1px;
                background: #3d3d3d;
                y: 0px;
            }
            
            HorizontalBox {
                padding: 8px;
                alignment: start;
                Text {
                    text: status_text;
                    font_size: 14px;
                    color: #cccccc;
                }
            }
        }
    }
}
